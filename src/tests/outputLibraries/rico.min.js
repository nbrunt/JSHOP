var Rico={Version:'2.1',loadRequested:1,loadComplete:2,init:function(){try{document.execCommand("BackgroundImageCache",!1,!0)}catch(a){}this.preloadMsgs='';var b=document.getElementsByTagName('script');this.baseHref=location.protocol+"//"+location.host;this.loadedFiles={};this.windowIsLoaded=!1;this.onLoadCallbacks=[];var c,d;for(var e=0;e<b.length;e++){if(!b[e].src)continue;var f=b[e].src;var g=f.lastIndexOf('/');var h=f.substring(0,g+1);c=f.substring(g+1);var i=c.indexOf('?');if(i>0)c=c.substring(0,i);this.loadedFiles[c]=this.loadComplete;if(c=='rico.js'||c=='rico.min.js'){d=c;var j=(h.indexOf("/javascripts")>=0);if(j){this.jsDir="/javascripts/";this.cssDir="/stylesheets/";this.imgDir="/images/";this.htmDir="/";this.xslDir="/"}else{this.jsDir=h;this.cssDir=h+'css/';this.imgDir=h+'images/';this.htmDir=h;this.xslDir=h}}}if(!d)throw 'unable to locate rico.js or rico.min.js script element';if(typeof Prototype=='undefined'){if(typeof google=='object'&&google.load)google.load('prototype','1.6'); else this.include('prototype.js')}if(d=='rico.js'){this.include('ricoCommon.js');this.languageInclude('en')}var k=function(){Rico.windowLoaded()};if(window.addEventListener)window.addEventListener('load',k,!1); else if(window.attachEvent)window.attachEvent('onload',k);this.onLoad(function(){Rico.writeDebugMsg('Pre-load messages:\n'+Rico.preloadMsgs)})},moduleDependencies:{Accordion:['ricoBehaviors.js','ricoEffects.js','ricoComponents.js'],Color:['ricoStyles.js'],Corner:['ricoStyles.js'],DragAndDrop:['ricoStyles.js','ricoEffects.js','ricoDragDrop.js'],Effect:['ricoEffects.js'],Calendar:['ricoCalendar.js','ricoCalendar.css'],Tree:['ricoTree.js','ricoTree.css'],ColorPicker:['ricoColorPicker.js','ricoStyles.js','ricoColorPicker.css'],CustomMenu:['ricoMenu.js','ricoMenu.css'],SimpleGrid:['+Effect','ricoGridCommon.js','ricoGrid.css','ricoSimpleGrid.js'],LiveGridBasic:['ricoGridCommon.js','ricoGrid.css','ricoBehaviors.js','ricoLiveGrid.js'],LiveGrid:['+Effect','+LiveGridBasic','ricoLiveGridControls.js'],LiveGridMenu:['+CustomMenu','ricoLiveGridMenu.js'],LiveGridAjax:['+LiveGrid','ricoLiveGridAjax.js'],LiveGridJSON:['+LiveGridAjax','ricoLiveGridJSON.js'],LiveGridForms:['+LiveGridAjax','+LiveGridMenu','+Accordion','+Corner','ricoLiveGridForms.js','ricoLiveGridForms.css'],SpreadSheet:['+SimpleGrid','ricoSheet.js','ricoSheet.css']},languages:{de:"translations/ricoLocale_de.js",en:"translations/ricoLocale_en.js",es:"translations/ricoLocale_es.js",fr:"translations/ricoLocale_fr.js",it:"translations/ricoLocale_it.js",ja:"translations/ricoLocale_ja.js",ko:"translations/ricoLocale_ko.js",pt:"translations/ricoLocale_pt.js",zh:"translations/ricoLocale_zh.js"},languageInclude:function(a){var b=this.languages[a];if(b)this.include(b);return !!b},acceptLanguage:function(a){var b=a.toLowerCase().split(',');for(var c=0;c<b.length;c++){var d=b[c].match(/\w\w/);if(!d)continue;if(this.languageInclude(d))return !0}return !1},loadModule:function(){for(var a=0,b=arguments.length;a<b;a++){var c=arguments[a];var d=this.moduleDependencies[c];if(d){for(var e=0;e<d.length;e++){if(d[e].substring(0,1)=='+'){this.loadModule(d[e].slice(1))}else{this.include(d[e])}}}else{this.include(c)}}},include:function(a){if(this.loadedFiles[a])return;this.addPreloadMsg('include: '+a);var b=a.substr(a.lastIndexOf('.')+1);switch(b.toLowerCase()){case 'js':this.loadedFiles[a]=a.substring(0,4)=='rico'?this.loadRequested:this.loadComplete;document.write("<script type='text/javascript' src='"+this.jsDir+a+"'><\/script>");return;case 'css':var c=document.createElement('link');c.type='text/css';c.rel='stylesheet';c.href=this.cssDir+a;this.loadedFiles[a]=this.loadComplete;document.getElementsByTagName('head')[0].appendChild(c);return}},includeLoaded:function(a){this.loadedFiles[a]=this.loadComplete;this.checkIfComplete()},windowLoaded:function(){this.windowIsLoaded=!0;this.checkIfComplete()},checkIfComplete:function(){var a=this.windowIsLoaded?'':'window';for(var b in this.loadedFiles){if(this.loadedFiles[b]==this.loadRequested)a+=' '+b}this.addPreloadMsg('waitingFor: '+a);if(a.length==0){this.addPreloadMsg('Processing callbacks');while(this.onLoadCallbacks.length>0){var c=this.onLoadCallbacks.shift();if(c)c()}}},onLoad:function(a,b){if(b)this.onLoadCallbacks.unshift(a); else this.onLoadCallbacks.push(a);this.checkIfComplete()},isKonqueror:navigator.userAgent.toLowerCase().indexOf("konqueror")>=0,startTime:new Date(),timeStamp:function(){var a=new Date();return (a.getTime()-this.startTime.getTime())+": "},setDebugArea:function(a,b){if(!this.debugArea||b){var c=document.getElementById(a);if(!c)return;this.debugArea=c;c.value=''}},addPreloadMsg:function(a){this.preloadMsgs+=Rico.timeStamp()+a+"\n"},writeDebugMsg:function(a,b){if(this.debugArea){if(b)this.debugArea.value='';this.debugArea.value+=this.timeStamp()+a+"\n"}else if(window.console){if(window.console.firebug)window.console.log(this.timeStamp(),a); else window.console.log(this.timeStamp()+a)}else if(window.opera){window.opera.postError(this.timeStamp()+a)}}};Rico.init();